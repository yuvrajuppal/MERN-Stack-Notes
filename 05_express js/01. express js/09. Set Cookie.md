```
npm install express cookie-parser jsonwebtoken
```

## locahost cookie set

```js
const express = require('express');
const cookieParser = require('cookie-parser');
const cors = require('cors');
const jwt = require('jsonwebtoken');

const app = express();

// 1. CORS Configuration is MANDATORY for localhost cross-port
app.use(cors({
    origin: 'http://localhost:3000', // Your Frontend URL
    credentials: true                // Allows cookies to be sent/received
}));

app.use(cookieParser());

app.get('/login', (req, res) => {
    const token = jwt.sign({ id: 1 }, "SECRET", { expiresIn: '7d' });

    // 2. Cookie Settings for Localhost
    res.cookie('auth_token', token, {
        httpOnly: true,     
        secure: false,      // Set to FALSE for localhost (HTTP)
        sameSite: 'Lax',    // Works best for same-device local dev
        maxAge: 7 * 24 * 60 * 60 * 1000 
    });

    res.send({ message: "Logged in!" });
});

app.listen(5000, () => console.log("Backend on port 5000"));
```


## for production
```js
// Express.js Backend
res.cookie('auth_token', token, {
    httpOnly: true,     
    secure: true,       // REQUIRED for sameSite: 'None'
    sameSite: 'None',   // REQUIRED for different domains
    maxAge: 7 * 24 * 60 * 60 * 1000 
});
```


### The Three Values of `sameSite`
There are three main settings you can use in your Node.js/Express `res.cookie()` setup:
#### 1. `sameSite: 'Strict'`
This is the most secure setting. The browser will **only** send the cookie if the request originates from the **same site** where the cookie was set.
- **Scenario:** If a user clicks a link to your site from an email or a Google search, the browser **will not** send the session cookie initially. The user will appear "logged out" until they navigate further within your site.
- **Best for:** Highly sensitive applications (banking, admin panels).
#### 2. `sameSite: 'Lax'` (The Modern Default)
This is the "balanced" approach and is now the default in most modern browsers (Chrome, Firefox, Edge).
- **Behaviour:** It blocks cookies on "cross-site" sub-requests (like images or `<iframe>` tags loaded from another site), but **allows** the cookie to be sent when a user follows a top-level link (a standard `<a>` tag) to your site.
- **Best for:** Most standard websites. It provides security while ensuring users stay logged in when clicking a link to your site from elsewhere.
#### 3. `sameSite: 'None'`
The cookie will be sent in **all** contexts, including cross-site requests.
- **Requirement:** If you use `None`, you **must** also set the `secure: true` flag (HTTPS only), or the browser will reject the cookie entirely.
- **Best for:** Third-party widgets, embedded maps, or if your frontend and backend are hosted on completely different domains (e.g., `myfrontend.com` and `myapi.com`).




### How cookie age works behind the scenes:

1. **Storage:** When your Node.js server sends the `Set-Cookie` header with `maxAge: 7 * 24 * 60 * 60 * 1000`, the browser saves that cookie in its local storage and marks it with a specific "Expiration Date."
    
2. **Automatic Cleanup:** The browser constantly checks this date. The millisecond that time passes, the browser **instantly deletes** the cookie.
    
3. **Request Handling:** Once deleted, the browser will no longer include that cookie in any future requests to your server. Your backend will see `req.cookies.auth_token` as `undefined`, effectively logging the user out.